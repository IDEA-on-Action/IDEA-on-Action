# Claude Skills 제약사항

> Claude Skills 통합 시 고려해야 할 기술적, 비즈니스적 제약사항

**작성일**: 2025-11-23
**버전**: 1.0.0
**상태**: Draft
**관련 명세**: [requirements.md](requirements.md)

---

## 1. 기술적 제약사항

### 1.1 Supabase 플랫폼 제약

| 항목 | 제약 | 영향 | 대응 방안 |
|------|------|------|----------|
| Edge Function 메모리 | 50MB 제한 | 대용량 Excel 생성 불가 | 클라이언트 사이드 생성 |
| Edge Function 실행 시간 | 60초 제한 | 복잡한 문서 생성 제약 | 비동기 처리 + 폴링 |
| Realtime 연결 | Free 플랜 200개 제한 | 동시 접속자 제약 | 연결 풀링 최적화 |
| Storage 용량 | Free 플랜 1GB 제한 | 생성 파일 보관 제약 | 7일 자동 삭제 정책 |

### 1.2 Deno 런타임 제약

| 항목 | 제약 | 영향 | 대응 방안 |
|------|------|------|----------|
| npm 패키지 호환성 | 일부 Node.js 패키지 미지원 | xlsx, docx 라이브러리 선택 제한 | Deno 호환 라이브러리 사용 |
| 파일 시스템 | 읽기 전용 환경 | 임시 파일 생성 불가 | 메모리 내 처리 |
| 환경 변수 | Supabase Secrets 필수 | 민감 정보 관리 제약 | Vault 패턴 적용 |

### 1.3 브라우저/프론트엔드 제약

| 항목 | 제약 | 영향 | 대응 방안 |
|------|------|------|----------|
| 브라우저 메모리 | 탭당 ~2GB 제한 | 대용량 Excel 생성 제약 | 서버 생성 + 다운로드 |
| Web Worker | 일부 API 미지원 | 백그라운드 처리 제한 | 메인 스레드 최적화 |
| 파일 다운로드 | Blob URL 메모리 점유 | 메모리 누수 가능성 | URL.revokeObjectURL 필수 |
| CORS | 외부 리소스 접근 제한 | 이미지/폰트 임베딩 제약 | Proxy 또는 Base64 변환 |

### 1.4 라이브러리 제약

| 라이브러리 | 제약 | 영향 | 대응 방안 |
|------------|------|------|----------|
| SheetJS (xlsx) | 차트 기능 제한 | 고급 차트 생성 불가 | 이미지로 차트 삽입 |
| docx | 복잡한 레이아웃 제한 | 고급 서식 제약 | 템플릿 기반 접근 |
| pptx | 커뮤니티 지원 제한 | 버그 수정 지연 가능 | 대안 라이브러리 검토 |

---

## 2. 비즈니스 제약사항

### 2.1 기존 시스템 호환성

| 항목 | 제약 | 대응 방안 |
|------|------|----------|
| Central Hub Phase 1 | 웹훅/이벤트 인프라 의존 | Phase 1 완료 후 진행 |
| 기존 MCP 서버 | 구조 변경 최소화 | 확장 방식으로 통합 |
| 현재 인증 시스템 | Supabase Auth 유지 | JWT 확장으로 서비스 토큰 추가 |
| 기존 UI 컴포넌트 | shadcn/ui 스타일 통일 | 새 컴포넌트도 동일 스타일 적용 |

### 2.2 점진적 마이그레이션

| 원칙 | 설명 |
|------|------|
| 기존 기능 유지 | 새 기능 추가 시 기존 기능 영향 없음 |
| 단계별 배포 | Sprint 단위로 검증 후 프로덕션 배포 |
| 롤백 가능 | 문제 발생 시 이전 버전으로 복구 가능 |
| Feature Flag | 새 기능은 플래그로 제어 가능 |

### 2.3 브랜드 가이드라인

| 항목 | 요구사항 |
|------|----------|
| 색상 | Minu 시리즈 통일 팔레트 (Find: 파랑, Frame: 초록, Build: 주황, Keep: 보라) |
| 폰트 | Inter (본문), JetBrains Mono (코드) |
| 아이콘 | Lucide Icons 사용 |
| 로고 | 문서 헤더에 IDEA on Action 로고 포함 |

---

## 3. 성능 제약사항

### 3.1 응답 시간 요구사항

| 작업 | 최대 응답 시간 | 구현 방법 |
|------|---------------|----------|
| Excel 1,000행 | 3초 | 스트리밍 + 워커 |
| Word 10페이지 | 2초 | 템플릿 캐싱 |
| 대시보드 로딩 | 2초 | 코드 스플리팅 + 캐싱 |
| Realtime 업데이트 | 100ms | WebSocket 최적화 |
| API 호출 | p95 500ms | 인덱스 + 캐싱 |

### 3.2 처리량 요구사항

| 작업 | 최대 동시 처리 | 구현 방법 |
|------|---------------|----------|
| 문서 생성 | 100건/분 | 큐 기반 처리 |
| API 요청 | 1,000 RPS | Rate Limiting |
| Realtime 연결 | 200개 | 연결 풀링 |
| 파일 다운로드 | 50건/분 | CDN 활용 |

---

## 4. 보안 제약사항

### 4.1 인증/인가

| 항목 | 요구사항 | 구현 방법 |
|------|----------|----------|
| API 인증 | 모든 API 호출에 JWT 필수 | Authorization 헤더 |
| 서비스 인증 | 서비스 간 통신에 서비스 토큰 필수 | HMAC 서명 |
| 역할 기반 접근 | admin, user, guest 구분 | RLS 정책 |
| 세션 관리 | 토큰 유효기간 1시간, Refresh 7일 | 토큰 갱신 로직 |

### 4.2 데이터 보호

| 항목 | 요구사항 | 구현 방법 |
|------|----------|----------|
| 전송 암호화 | HTTPS 필수 | Vercel/Supabase 기본 제공 |
| 저장 암호화 | 민감 데이터 암호화 | Supabase 암호화 기능 |
| 파일 접근 | 서명된 URL 사용, 1시간 만료 | createSignedUrl |
| 로그 마스킹 | 민감 정보 로그 제외 | 로그 필터 적용 |

### 4.3 감사 로그

| 이벤트 | 기록 항목 |
|--------|----------|
| 문서 생성 | 사용자 ID, 문서 유형, 생성 시간 |
| 파일 다운로드 | 사용자 ID, 파일명, 다운로드 시간 |
| 권한 변경 | 변경자 ID, 대상 사용자, 변경 내용 |
| 로그인 | 사용자 ID, IP, 시간, 성공/실패 |

---

## 5. 확장성 제약사항

### 5.1 새 Skill 추가 절차

```
1. spec/claude-skills/에 요구사항 추가
2. plan/claude-skills/에 설계 추가
3. tasks/claude-skills/에 작업 분해
4. 구현 및 테스트
5. 문서 업데이트
6. 프로덕션 배포
```

### 5.2 새 서비스 추가 절차

| 단계 | 작업 | 예상 시간 |
|------|------|----------|
| 1 | service_health 테이블에 레코드 추가 | 10분 |
| 2 | 웹훅 시크릿 환경 변수 추가 | 10분 |
| 3 | Edge Function 서비스 ID CHECK 제약 수정 | 20분 |
| 4 | TypeScript SERVICE_INFO 상수 추가 | 10분 |
| 5 | UI 컴포넌트 서비스 추가 | 1시간 |
| **총** | | **2시간** |

### 5.3 새 템플릿 추가 절차

| 단계 | 작업 |
|------|------|
| 1 | 템플릿 파일 생성 (templates/ 디렉토리) |
| 2 | 변수 매핑 정의 (JSON 스키마) |
| 3 | 관리자 UI에 템플릿 등록 |
| 4 | 테스트 케이스 작성 |

---

## 6. 운영 제약사항

### 6.1 모니터링

| 항목 | 도구 | 알림 조건 |
|------|------|----------|
| 에러 추적 | Sentry | 에러 발생 즉시 |
| 성능 모니터링 | Vercel Analytics | p95 > 500ms |
| 가용성 | Supabase Status | 다운타임 감지 |
| 로그 | Supabase Logs | 에러 레벨 로그 |

### 6.2 배포

| 환경 | 배포 방법 | 승인 |
|------|----------|------|
| 개발 | PR 병합 시 자동 | 자동 |
| 스테이징 | main 브랜치 푸시 | 자동 |
| 프로덕션 | 수동 배포 | 관리자 승인 |

### 6.3 백업 및 복구

| 항목 | 정책 |
|------|------|
| DB 백업 | 일일 자동 백업 (Supabase 기본) |
| 파일 백업 | 7일 보관 후 자동 삭제 |
| 복구 목표 | RTO 1시간, RPO 1시간 |
| 롤백 | Vercel 이전 배포로 즉시 롤백 가능 |

---

## 7. 예산 제약사항

### 7.1 Supabase 무료 플랜 한계

| 리소스 | 무료 한도 | 예상 사용량 | 대응 |
|--------|----------|------------|------|
| DB 용량 | 500MB | 200MB (예상) | 충분 |
| Storage | 1GB | 500MB (예상) | 파일 자동 삭제 |
| Edge Function 호출 | 500,000/월 | 100,000 (예상) | 충분 |
| Realtime 연결 | 200 동시 | 50 (예상) | 충분 |

### 7.2 비용 최적화 전략

| 전략 | 설명 |
|------|------|
| 캐싱 | React Query 5분 TTL, Edge Function 캐싱 |
| 압축 | gzip 압축으로 전송량 절감 |
| 지연 로딩 | 필요한 시점에만 데이터 로드 |
| 정리 작업 | 7일 지난 생성 파일 자동 삭제 |

### 7.3 향후 유료 플랜 전환 기준

| 지표 | 임계값 | 조치 |
|------|--------|------|
| DB 용량 | 400MB 초과 | Pro 플랜 검토 |
| API 호출 | 400,000/월 초과 | Pro 플랜 검토 |
| 동시 사용자 | 150명 초과 | Pro 플랜 검토 |

---

## 8. 의존성 제약사항

### 8.1 필수 선행 작업

| 작업 | 상태 | 영향 |
|------|------|------|
| Central Hub Phase 1 | ✅ 완료 | Skills가 이벤트 데이터 활용 |
| Central Hub Phase 2 | ⏳ 대기 | MCP 권한 기반 접근 제어 |
| Minu 서비스 페이지 | ✅ 완료 | Skills 결과 표시 UI |

### 8.2 외부 서비스 의존성

| 서비스 | 용도 | 대안 |
|--------|------|------|
| Supabase | DB, Auth, Realtime, Storage | 없음 (핵심 인프라) |
| Vercel | 호스팅, Edge Function | Netlify |
| Sentry | 에러 추적 | LogRocket |
| GitHub | 코드 저장소 | GitLab |

---

## 변경 이력

| 버전 | 날짜 | 변경 내용 | 작성자 |
|------|------|----------|--------|
| 1.0.0 | 2025-11-23 | 초기 작성 | Claude |
