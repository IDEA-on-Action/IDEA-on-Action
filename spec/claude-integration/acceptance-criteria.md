# Claude AI 통합 인수 조건

> Claude AI 통합의 성공 기준 및 검증 방법

**작성일**: 2025-11-24
**버전**: 1.0.0
**상태**: Draft
**관련 명세**: [requirements.md](requirements.md)

---

## 1. Claude API 연동 (FR-CI-01)

### AC-CI-01.1: API 클라이언트 기본 기능

| ID | 조건 | 검증 방법 |
|----|------|----------|
| AC-CI-01.1.1 | Claude API 호출 시 유효한 응답 수신 | 통합 테스트 |
| AC-CI-01.1.2 | API 키가 Supabase Vault에 안전하게 저장됨 | 보안 검증 |
| AC-CI-01.1.3 | 인증 실패 시 적절한 에러 메시지 반환 | 단위 테스트 |
| AC-CI-01.1.4 | Rate Limit 초과 시 429 에러 처리 및 재시도 | 부하 테스트 |
| AC-CI-01.1.5 | 요청 타임아웃(60초) 시 적절한 처리 | 타임아웃 테스트 |

### AC-CI-01.2: 스트리밍 응답

| ID | 조건 | 검증 방법 |
|----|------|----------|
| AC-CI-01.2.1 | 스트리밍 활성화 시 실시간 토큰 수신 | E2E 테스트 |
| AC-CI-01.2.2 | 첫 토큰 응답 시간(TTFT) 2초 이내 | 성능 테스트 |
| AC-CI-01.2.3 | 스트리밍 중단 시 부분 응답 표시 | E2E 테스트 |
| AC-CI-01.2.4 | SSE(Server-Sent Events) 연결 안정성 확보 | 네트워크 테스트 |

### AC-CI-01.3: 멀티턴 대화

| ID | 조건 | 검증 방법 |
|----|------|----------|
| AC-CI-01.3.1 | 이전 대화 컨텍스트 유지 (최대 10턴) | E2E 테스트 |
| AC-CI-01.3.2 | 세션별 대화 히스토리 저장 | 통합 테스트 |
| AC-CI-01.3.3 | 컨텍스트 윈도우 초과 시 오래된 메시지 제거 | 단위 테스트 |
| AC-CI-01.3.4 | 새 세션 시작 시 컨텍스트 초기화 | E2E 테스트 |

### AC-CI-01.4: 프롬프트 관리

| ID | 조건 | 검증 방법 |
|----|------|----------|
| AC-CI-01.4.1 | 서비스별 시스템 프롬프트 적용 | 단위 테스트 |
| AC-CI-01.4.2 | {{변수}} 형식 동적 치환 100% 정확 | 단위 테스트 |
| AC-CI-01.4.3 | 프롬프트 템플릿 DB 저장 및 조회 | 통합 테스트 |
| AC-CI-01.4.4 | 프롬프트 버전 히스토리 추적 | 통합 테스트 |

---

## 2. 문서 분석 기능 (FR-CI-02)

### AC-CI-02.1: 파일 업로드 및 처리

| ID | 조건 | 검증 방법 |
|----|------|----------|
| AC-CI-02.1.1 | PDF 파일 업로드 및 텍스트 추출 | E2E 테스트 |
| AC-CI-02.1.2 | Word(.docx) 파일 업로드 및 텍스트 추출 | E2E 테스트 |
| AC-CI-02.1.3 | 10MB 초과 파일 업로드 거부 및 안내 | E2E 테스트 |
| AC-CI-02.1.4 | 지원하지 않는 형식 업로드 시 에러 메시지 | E2E 테스트 |
| AC-CI-02.1.5 | 파일 처리 진행률 표시 | E2E 테스트 |

### AC-CI-02.2: 문서 요약

| ID | 조건 | 검증 방법 |
|----|------|----------|
| AC-CI-02.2.1 | 한 줄 요약(50자 이내) 생성 | 출력 검증 |
| AC-CI-02.2.2 | 핵심 포인트 5개 추출 | 출력 검증 |
| AC-CI-02.2.3 | 상세 요약(500자 이내) 생성 | 출력 검증 |
| AC-CI-02.2.4 | 10페이지 문서 요약 10초 이내 완료 | 성능 테스트 |
| AC-CI-02.2.5 | 한글 문서 정확한 요약 | 품질 테스트 |

### AC-CI-02.3: 문서 유형 분류

| ID | 조건 | 검증 방법 |
|----|------|----------|
| AC-CI-02.3.1 | RFP/제안요청서 자동 감지 (정확도 90%+) | 분류 테스트 |
| AC-CI-02.3.2 | 계약서 자동 감지 (정확도 90%+) | 분류 테스트 |
| AC-CI-02.3.3 | 보고서 자동 감지 (정확도 90%+) | 분류 테스트 |
| AC-CI-02.3.4 | 매뉴얼 자동 감지 (정확도 90%+) | 분류 테스트 |
| AC-CI-02.3.5 | 분류 결과와 신뢰도 점수 함께 반환 | 출력 검증 |

### AC-CI-02.4: Q&A 인터페이스

| ID | 조건 | 검증 방법 |
|----|------|----------|
| AC-CI-02.4.1 | 업로드 문서 기반 질문 응답 | E2E 테스트 |
| AC-CI-02.4.2 | 문서 내용에 없는 질문 시 "정보 없음" 응답 | E2E 테스트 |
| AC-CI-02.4.3 | 응답에 관련 문서 위치(페이지/섹션) 표시 | 출력 검증 |
| AC-CI-02.4.4 | 연속 질문 시 이전 대화 맥락 유지 | E2E 테스트 |

---

## 3. 콘텐츠 생성 기능 (FR-CI-03)

### AC-CI-03.1: RFP 자동 생성

| ID | 조건 | 검증 방법 |
|----|------|----------|
| AC-CI-03.1.1 | 프로젝트 개요 입력 시 RFP 초안 생성 | E2E 테스트 |
| AC-CI-03.1.2 | 정부 SI 표준 양식 준수 | 템플릿 검증 |
| AC-CI-03.1.3 | 스타트업 MVP 간결 양식 생성 | 템플릿 검증 |
| AC-CI-03.1.4 | 엔터프라이즈 상세 양식 생성 | 템플릿 검증 |
| AC-CI-03.1.5 | 생성 시간 60초 이내 | 성능 테스트 |

### AC-CI-03.2: 요구사항 분류

| ID | 조건 | 검증 방법 |
|----|------|----------|
| AC-CI-03.2.1 | 기능/비기능 요구사항 자동 분류 (정확도 85%+) | 분류 테스트 |
| AC-CI-03.2.2 | MoSCoW 우선순위 추천 제공 | 출력 검증 |
| AC-CI-03.2.3 | 요구사항 ID 자동 부여 (FR-001, NFR-001 형식) | 출력 검증 |
| AC-CI-03.2.4 | 중복/모순 요구사항 감지 및 경고 | 검증 테스트 |

### AC-CI-03.3: 평가 기준 생성

| ID | 조건 | 검증 방법 |
|----|------|----------|
| AC-CI-03.3.1 | 프로젝트 유형별 평가 기준 추천 | 출력 검증 |
| AC-CI-03.3.2 | 배점 합계 100점 자동 계산 | 단위 테스트 |
| AC-CI-03.3.3 | 평가 기준 커스터마이징 가능 | E2E 테스트 |

### AC-CI-03.4: 보고서 생성

| ID | 조건 | 검증 방법 |
|----|------|----------|
| AC-CI-03.4.1 | 주간 보고서 초안 생성 (진행률/이슈/계획) | 템플릿 검증 |
| AC-CI-03.4.2 | 월간 보고서 초안 생성 (KPI/트렌드/개선) | 템플릿 검증 |
| AC-CI-03.4.3 | 장애 대응 보고서 생성 (원인/영향/조치) | 템플릿 검증 |
| AC-CI-03.4.4 | 데이터 기반 자동 채우기 | 통합 테스트 |

---

## 4. 채팅 인터페이스 (FR-CI-04)

### AC-CI-04.1: UI 컴포넌트

| ID | 조건 | 검증 방법 |
|----|------|----------|
| AC-CI-04.1.1 | 채팅 윈도우 반응형 레이아웃 (모바일/데스크톱) | 반응형 테스트 |
| AC-CI-04.1.2 | 사용자/AI 메시지 시각적 구분 | 수동 검증 |
| AC-CI-04.1.3 | 마크다운 렌더링 (제목, 목록, 굵게, 기울임) | 렌더링 테스트 |
| AC-CI-04.1.4 | 코드 블록 구문 강조 | 렌더링 테스트 |
| AC-CI-04.1.5 | 테이블 렌더링 | 렌더링 테스트 |

### AC-CI-04.2: 입력 기능

| ID | 조건 | 검증 방법 |
|----|------|----------|
| AC-CI-04.2.1 | 텍스트 입력 및 전송 (Enter 또는 버튼) | E2E 테스트 |
| AC-CI-04.2.2 | 멀티라인 입력 지원 (Shift+Enter) | E2E 테스트 |
| AC-CI-04.2.3 | 파일 첨부 버튼 및 드래그앤드롭 | E2E 테스트 |
| AC-CI-04.2.4 | 전송 중 입력 비활성화 | E2E 테스트 |
| AC-CI-04.2.5 | 입력 길이 제한 (10,000자) 및 안내 | E2E 테스트 |

### AC-CI-04.3: 스트리밍 표시

| ID | 조건 | 검증 방법 |
|----|------|----------|
| AC-CI-04.3.1 | 응답 중 타이핑 애니메이션 표시 | 수동 검증 |
| AC-CI-04.3.2 | 토큰 단위 실시간 텍스트 추가 | E2E 테스트 |
| AC-CI-04.3.3 | 응답 완료 시 애니메이션 종료 | E2E 테스트 |
| AC-CI-04.3.4 | 응답 중 "중지" 버튼으로 취소 가능 | E2E 테스트 |

### AC-CI-04.4: 대화 관리

| ID | 조건 | 검증 방법 |
|----|------|----------|
| AC-CI-04.4.1 | 새 대화 시작 버튼 | E2E 테스트 |
| AC-CI-04.4.2 | 대화 히스토리 목록 표시 | E2E 테스트 |
| AC-CI-04.4.3 | 이전 대화 불러오기 | E2E 테스트 |
| AC-CI-04.4.4 | 대화 삭제 기능 | E2E 테스트 |
| AC-CI-04.4.5 | 대화 제목 자동 생성 (첫 메시지 기반) | 통합 테스트 |

---

## 5. Skills 연동 (FR-CI-05)

### AC-CI-05.1: AI → xlsx 연동

| ID | 조건 | 검증 방법 |
|----|------|----------|
| AC-CI-05.1.1 | AI 분석 결과 JSON → Excel 변환 | 통합 테스트 |
| AC-CI-05.1.2 | 시장분석 매트릭스 Excel 생성 | E2E 테스트 |
| AC-CI-05.1.3 | 경쟁사 비교표 Excel 생성 | E2E 테스트 |
| AC-CI-05.1.4 | 생성된 Excel 파일 다운로드 | E2E 테스트 |

### AC-CI-05.2: AI → docx 연동

| ID | 조건 | 검증 방법 |
|----|------|----------|
| AC-CI-05.2.1 | AI 생성 RFP → Word 문서 변환 | 통합 테스트 |
| AC-CI-05.2.2 | AI 생성 보고서 → Word 문서 변환 | 통합 테스트 |
| AC-CI-05.2.3 | 마크다운 → Word 스타일 매핑 | 스타일 검증 |
| AC-CI-05.2.4 | 생성된 Word 파일 다운로드 | E2E 테스트 |

### AC-CI-05.3: AI → pptx 연동

| ID | 조건 | 검증 방법 |
|----|------|----------|
| AC-CI-05.3.1 | AI 제안서 구조 → PowerPoint 변환 | 통합 테스트 |
| AC-CI-05.3.2 | 슬라이드 제목/내용 자동 배치 | 레이아웃 검증 |
| AC-CI-05.3.3 | IDEA on Action 브랜드 스타일 적용 | 수동 검증 |
| AC-CI-05.3.4 | 생성된 PPT 파일 다운로드 | E2E 테스트 |

---

## 6. 권한 및 사용량 관리 (FR-CI-06)

### AC-CI-06.1: MCP 권한 연동

| ID | 조건 | 검증 방법 |
|----|------|----------|
| AC-CI-06.1.1 | MCP 토큰에 claude_access 클레임 포함 | 토큰 검증 |
| AC-CI-06.1.2 | AI 기능 호출 시 권한 검증 | 통합 테스트 |
| AC-CI-06.1.3 | 권한 없는 사용자 AI 기능 차단 | E2E 테스트 |
| AC-CI-06.1.4 | 권한 부족 시 업그레이드 안내 표시 | E2E 테스트 |

### AC-CI-06.2: 플랜별 제한

| ID | 조건 | 검증 방법 |
|----|------|----------|
| AC-CI-06.2.1 | 무료 플랜: 일일 50회 제한 적용 | E2E 테스트 |
| AC-CI-06.2.2 | Pro 플랜: 일일 500회 제한 적용 | E2E 테스트 |
| AC-CI-06.2.3 | Enterprise: 무제한 사용 | 통합 테스트 |
| AC-CI-06.2.4 | 한도 초과 시 차단 및 안내 | E2E 테스트 |

### AC-CI-06.3: 사용량 추적

| ID | 조건 | 검증 방법 |
|----|------|----------|
| AC-CI-06.3.1 | 모든 API 호출 토큰 사용량 기록 | DB 검증 |
| AC-CI-06.3.2 | 사용자별 일/월 사용량 집계 | 쿼리 테스트 |
| AC-CI-06.3.3 | 관리자 대시보드에서 사용량 조회 | E2E 테스트 |
| AC-CI-06.3.4 | 80% 도달 시 경고 알림 | 알림 테스트 |
| AC-CI-06.3.5 | 100% 도달 시 차단 알림 | 알림 테스트 |

---

## 7. 보안 요구사항 (NFR-CI-02)

### AC-CI-07.1: API 키 보안

| ID | 조건 | 검증 방법 |
|----|------|----------|
| AC-CI-07.1.1 | API 키 Supabase Vault 암호화 저장 | 보안 검증 |
| AC-CI-07.1.2 | API 키 클라이언트 노출 없음 | 코드 리뷰 |
| AC-CI-07.1.3 | Edge Function에서만 API 키 접근 | 아키텍처 검증 |
| AC-CI-07.1.4 | 로그에 API 키 미포함 | 로그 검증 |

### AC-CI-07.2: 데이터 보호

| ID | 조건 | 검증 방법 |
|----|------|----------|
| AC-CI-07.2.1 | 대화 로그 30일 후 자동 삭제 | 스케줄 검증 |
| AC-CI-07.2.2 | 사용자별 데이터 격리 (RLS) | RLS 테스트 |
| AC-CI-07.2.3 | 업로드 파일 7일 후 자동 삭제 | 스케줄 검증 |
| AC-CI-07.2.4 | 민감 정보 마스킹 옵션 제공 | E2E 테스트 |

### AC-CI-07.3: 입력 검증

| ID | 조건 | 검증 방법 |
|----|------|----------|
| AC-CI-07.3.1 | 프롬프트 인젝션 패턴 필터링 | 보안 테스트 |
| AC-CI-07.3.2 | 악성 파일 업로드 차단 | 보안 테스트 |
| AC-CI-07.3.3 | XSS 스크립트 이스케이프 | 보안 테스트 |
| AC-CI-07.3.4 | 과도한 입력 길이 제한 | E2E 테스트 |

---

## 8. 성능 요구사항 (NFR-CI-01)

### AC-CI-08.1: 응답 시간

| ID | 조건 | 검증 방법 |
|----|------|----------|
| AC-CI-08.1.1 | 첫 토큰 응답 시간(TTFT) p95 2초 이내 | 성능 테스트 |
| AC-CI-08.1.2 | 짧은 질문 전체 응답 p95 3초 이내 | 성능 테스트 |
| AC-CI-08.1.3 | 문서 요약 10페이지 p95 15초 이내 | 성능 테스트 |
| AC-CI-08.1.4 | RFP 생성 전체 p95 60초 이내 | 성능 테스트 |

### AC-CI-08.2: 동시성

| ID | 조건 | 검증 방법 |
|----|------|----------|
| AC-CI-08.2.1 | 시스템 전체 50개 동시 요청 처리 | 부하 테스트 |
| AC-CI-08.2.2 | 사용자당 1개 동시 요청 제한 | 통합 테스트 |
| AC-CI-08.2.3 | 대기열 초과 시 적절한 안내 | E2E 테스트 |

---

## 9. 서비스별 테스트 시나리오

### 9.1 Minu Find 시나리오

| 시나리오 | 단계 | 예상 결과 |
|----------|------|----------|
| 시장분석 리포트 생성 | 1. 시장 키워드 입력<br>2. AI 분석 요청<br>3. Excel 내보내기 | 경쟁사 매트릭스 Excel 다운로드 |
| 문서 분석 | 1. 시장조사 PDF 업로드<br>2. 요약 요청<br>3. Q&A | 3단계 요약 + 질문 응답 |

### 9.2 Minu Frame 시나리오

| 시나리오 | 단계 | 예상 결과 |
|----------|------|----------|
| RFP 자동 생성 | 1. 프로젝트 개요 입력<br>2. 템플릿 선택<br>3. AI 생성<br>4. Word 내보내기 | RFP Word 문서 다운로드 |
| 요구사항 분류 | 1. 요구사항 목록 입력<br>2. AI 분류 요청 | 기능/비기능 분류 + MoSCoW |

### 9.3 Minu Build 시나리오

| 시나리오 | 단계 | 예상 결과 |
|----------|------|----------|
| 주간 보고서 생성 | 1. 프로젝트 데이터 조회<br>2. AI 보고서 생성<br>3. Word 내보내기 | 주간 보고서 Word 다운로드 |
| 코드 리뷰 요청 | 1. 코드 붙여넣기<br>2. 리뷰 요청 | 보안/성능/스타일 피드백 |

### 9.4 Minu Keep 시나리오

| 시나리오 | 단계 | 예상 결과 |
|----------|------|----------|
| 장애 분석 | 1. 로그 파일 업로드<br>2. AI 분석 요청 | 근본 원인 분석 + 권고사항 |
| 운영 보고서 | 1. 운영 지표 조회<br>2. AI 보고서 생성<br>3. Excel+Word 내보내기 | 운영 리포트 다운로드 |

---

## 10. 검증 일정

### Sprint 1: 기반 구축 (1주)

- [ ] AC-CI-01.1.1 ~ AC-CI-01.1.5 (API 클라이언트)
- [ ] AC-CI-01.2.1 ~ AC-CI-01.2.4 (스트리밍)
- [ ] AC-CI-06.1.1 ~ AC-CI-06.1.4 (MCP 권한)
- [ ] AC-CI-07.1.1 ~ AC-CI-07.1.4 (API 키 보안)

### Sprint 2: 채팅 인터페이스 (1주)

- [ ] AC-CI-04.1.1 ~ AC-CI-04.1.5 (UI 컴포넌트)
- [ ] AC-CI-04.2.1 ~ AC-CI-04.2.5 (입력 기능)
- [ ] AC-CI-04.3.1 ~ AC-CI-04.3.4 (스트리밍 표시)
- [ ] AC-CI-01.3.1 ~ AC-CI-01.3.4 (멀티턴 대화)

### Sprint 3: 문서 분석 (1주)

- [ ] AC-CI-02.1.1 ~ AC-CI-02.1.5 (파일 처리)
- [ ] AC-CI-02.2.1 ~ AC-CI-02.2.5 (문서 요약)
- [ ] AC-CI-02.3.1 ~ AC-CI-02.3.5 (문서 분류)
- [ ] AC-CI-02.4.1 ~ AC-CI-02.4.4 (Q&A)

### Sprint 4: 콘텐츠 생성 + Skills 연동 (1주)

- [ ] AC-CI-03.1.1 ~ AC-CI-03.1.5 (RFP 생성)
- [ ] AC-CI-03.2.1 ~ AC-CI-03.2.4 (요구사항 분류)
- [ ] AC-CI-05.1.1 ~ AC-CI-05.1.4 (xlsx 연동)
- [ ] AC-CI-05.2.1 ~ AC-CI-05.2.4 (docx 연동)

### Sprint 5: 고도화 + 사용량 관리 (1주)

- [ ] AC-CI-03.3.1 ~ AC-CI-03.3.3 (평가 기준)
- [ ] AC-CI-03.4.1 ~ AC-CI-03.4.4 (보고서 생성)
- [ ] AC-CI-06.2.1 ~ AC-CI-06.2.4 (플랜별 제한)
- [ ] AC-CI-06.3.1 ~ AC-CI-06.3.5 (사용량 추적)
- [ ] AC-CI-05.3.1 ~ AC-CI-05.3.4 (pptx 연동)

---

## 변경 이력

| 버전 | 날짜 | 변경 내용 | 작성자 |
|------|------|----------|--------|
| 1.0.0 | 2025-11-24 | 초기 작성 | Claude |
