# Central Hub 요구사항 명세서

> IDEA on Action이 Minu 서비스들의 중심 시스템 역할을 수행하기 위한 요구사항

**작성일**: 2025-11-23
**버전**: 1.0.0
**상태**: Draft

---

## 1. 개요

### 1.1 목적
IDEA on Action은 Minu 서비스 제품군(Find, Frame, Build, Keep)의 **중심 허브** 역할을 수행합니다:
- 사용자 인증 및 권한 관리의 단일 진입점
- 서비스 사용 라이센스/구독 관리
- 외부 서비스로부터 진행 상태 및 이슈 수신
- 통합 모니터링 및 알림 제공

### 1.2 대상 서비스
| 서비스 | 역할 | 설명 |
|--------|------|------|
| **Minu Find** | 사업기회 탐색 | 시장 기회 발굴 및 아이디어 검증 |
| **Minu Frame** | 문제정의 & RFP | 요구사항 정의 및 제안서 작성 |
| **Minu Build** | 프로젝트 진행 | 실제 개발 및 구현 관리 |
| **Minu Keep** | 운영/유지보수 | 서비스 운영 및 지속적 개선 |

---

## 2. 사용자 스토리

### US-01: 통합 인증
> **As a** Minu 서비스 사용자
> **I want to** IDEA on Action 계정으로 모든 Minu 서비스에 로그인하고 싶다
> **So that** 각 서비스마다 별도 계정을 만들 필요가 없다

**인수 조건**:
- [ ] OAuth 로그인 시 JWT 토큰 발급
- [ ] 토큰으로 모든 Minu 서비스 인증 가능
- [ ] 토큰 만료 시 자동 갱신
- [ ] 세션 무효화 시 모든 서비스에서 로그아웃

### US-02: 구독 기반 접근 제어
> **As a** 구독자
> **I want to** 구독한 플랜에 따라 서비스 기능에 접근하고 싶다
> **So that** 내가 결제한 만큼의 가치를 얻을 수 있다

**인수 조건**:
- [ ] 구독 상태에 따른 기능 활성화/비활성화
- [ ] 플랜별 기능 목록 조회 API
- [ ] 구독 만료 시 기능 제한 적용
- [ ] 업그레이드/다운그레이드 즉시 반영

### US-03: 진행 상태 수신
> **As a** 프로젝트 관리자
> **I want to** 각 Minu 서비스에서 진행 중인 작업 상태를 한 곳에서 보고 싶다
> **So that** 전체 프로젝트 현황을 파악할 수 있다

**인수 조건**:
- [ ] 외부 서비스에서 상태 업데이트 웹훅 수신
- [ ] 실시간으로 상태 변화 반영
- [ ] 서비스별/프로젝트별 필터링
- [ ] 타임라인 뷰 제공

### US-04: 이슈 수신 및 알림
> **As a** 시스템 관리자
> **I want to** Minu 서비스에서 발생한 이슈를 즉시 알림 받고 싶다
> **So that** 문제를 빠르게 해결할 수 있다

**인수 조건**:
- [ ] 외부 서비스에서 이슈 리포트 웹훅 수신
- [ ] 심각도별 분류 (critical, high, medium, low)
- [ ] 관리자에게 앱 내/Slack/이메일 알림
- [ ] 이슈 상태 추적 (open, in_progress, resolved)

### US-05: 서비스 헬스 모니터링
> **As a** 시스템 관리자
> **I want to** 모든 Minu 서비스의 상태를 한 눈에 보고 싶다
> **So that** 서비스 장애를 빠르게 감지할 수 있다

**인수 조건**:
- [ ] 각 서비스의 헬스 상태 표시
- [ ] 연결 끊김 감지 및 알림
- [ ] 마지막 통신 시간 표시
- [ ] 서비스별 통계 (요청 수, 에러율)

---

## 3. 기능 요구사항

### FR-01: 웹훅 수신 시스템

#### FR-01.1: 이벤트 수신 엔드포인트
- HTTP POST 요청으로 이벤트 수신
- JSON 페이로드 파싱 및 검증
- HMAC 서명으로 요청 인증
- 비동기 처리로 빠른 응답 (200 OK 즉시 반환)

#### FR-01.2: 이벤트 유형
| 유형 | 설명 | 페이로드 |
|------|------|----------|
| `progress.updated` | 진행 상태 변경 | project_id, stage, progress, timestamp |
| `issue.created` | 새 이슈 생성 | issue_id, severity, title, description |
| `issue.resolved` | 이슈 해결 | issue_id, resolution |
| `service.health` | 서비스 헬스 체크 | service_id, status, metrics |

#### FR-01.3: 저장 구조
- `service_events` 테이블: 모든 이벤트 로그
- `service_issues` 테이블: 이슈 전용 테이블
- `service_health` 테이블: 헬스 상태 캐시

### FR-02: MCP 권한 확인

#### FR-02.1: 통합 권한 확인
- 모든 Minu 서비스 페이지에서 MCP 클라이언트 사용
- `check_permission` 도구로 기능 접근 권한 확인
- 권한 없을 시 적절한 UI 피드백

#### FR-02.2: 권한 캐싱
- 세션 동안 권한 정보 캐싱
- 구독 변경 시 캐시 무효화
- 5분 TTL 적용

### FR-03: 실시간 동기화

#### FR-03.1: Supabase Realtime 구독
- `service_events` 테이블 변경 실시간 감지
- `service_issues` 테이블 변경 실시간 감지
- 컴포넌트 자동 리렌더링

#### FR-03.2: 알림 발송
- 중요 이벤트 발생 시 관리자 알림
- Slack 웹훅 연동
- 이메일 알림 (선택적)

---

## 4. 비기능 요구사항

### NFR-01: 성능
- 웹훅 응답 시간: < 100ms
- 실시간 이벤트 전파: < 500ms
- 동시 웹훅 처리: 100 req/s 이상

### NFR-02: 보안
- HMAC-SHA256 서명 검증 필수
- TLS 1.2 이상 암호화
- Rate Limiting: 서비스당 1000 req/min

### NFR-03: 가용성
- 웹훅 엔드포인트 가용성: 99.9%
- 실패 시 재시도 메커니즘 (3회)
- Dead Letter Queue로 실패 이벤트 보관

### NFR-04: 확장성
- 새 Minu 서비스 추가 시 설정만으로 연동
- 이벤트 유형 확장 가능한 구조
- 수평 확장 가능한 아키텍처

---

## 5. 제약사항

### 기술적 제약
- Supabase Edge Functions 사용 (Deno 런타임)
- 단일 Edge Function 실행 시간 < 30초
- Supabase Realtime 채널 제한 고려

### 비즈니스 제약
- 기존 인증 시스템(useAuth) 유지
- 기존 MCP 서버 구조 활용
- 점진적 마이그레이션 (기존 기능 영향 최소화)

---

## 6. 우선순위

| 우선순위 | 기능 | 이유 |
|---------|------|------|
| P0 | 웹훅 수신 엔드포인트 | 외부 서비스 연동의 기반 |
| P0 | 이벤트/이슈 저장 테이블 | 데이터 영속성 필수 |
| P1 | MCP 통합 확대 | 일관된 권한 관리 |
| P1 | 실시간 구독 훅 | 사용자 경험 향상 |
| P2 | 알림 시스템 연동 | 운영 효율성 |
| P3 | 대시보드 UI | 시각화 |

---

## 변경 이력

| 버전 | 날짜 | 변경 내용 | 작성자 |
|------|------|----------|--------|
| 1.0.0 | 2025-11-23 | 초기 작성 | Claude |
