name: Quarterly Backlog Review

# ë¶„ê¸°ë³„ 1ì¼ (3/6/9/12ì›” 1ì¼) 00:00 (UTC)
on:
  schedule:
    - cron: '0 0 1 3,6,9,12 *'  # 3ì›”, 6ì›”, 9ì›”, 12ì›” 1ì¼
  workflow_dispatch:  # ìˆ˜ë™ ì‹¤í–‰ ê°€ëŠ¥

jobs:
  create-backlog-review-issue:
    name: Create Backlog Review Issue
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Get quarter info
        id: quarter
        run: |
          month=$(date +%m)
          year=$(date +%Y)

          if [ $month -eq 3 ]; then quarter="Q1"; fi
          if [ $month -eq 6 ]; then quarter="Q2"; fi
          if [ $month -eq 9 ]; then quarter="Q3"; fi
          if [ $month -eq 12 ]; then quarter="Q4"; fi

          echo "quarter=$quarter" >> $GITHUB_OUTPUT
          echo "year=$year" >> $GITHUB_OUTPUT

      - name: Create review issue
        uses: actions/github-script@v7
        with:
          script: |
            const quarter = '${{ steps.quarter.outputs.quarter }}';
            const year = '${{ steps.quarter.outputs.year }}';

            const issue = await github.rest.issues.create({
              owner: context.repo.owner,
              repo: context.repo.repo,
              title: `ðŸ“‹ ${year} ${quarter} ë°±ë¡œê·¸ ìš°ì„ ìˆœìœ„ ìž¬ê²€í† `,
              body: `## ðŸ“‹ ë¶„ê¸°ë³„ ë°±ë¡œê·¸ ìž¬ê²€í† 

            **ë¶„ê¸°**: ${year} ${quarter}
            **ìƒì„± ë‚ ì§œ**: ${new Date().toISOString().split('T')[0]}
            **ìžë™í™”**: GitHub Actions (quarterly-backlog-review.yml)

            ### ê²€í†  í•­ëª©

            #### 1. ì§„í–‰ ì¤‘ ìž‘ì—… í™•ì¸
            - [ ] í˜„ìž¬ ì§„í–‰ ì¤‘ì¸ Phase/Sprint í™•ì¸
            - [ ] ì˜ˆìƒ ì™„ë£Œ ì¼ì • ê²€í† 
            - [ ] ë¸”ë¡œì»¤ í™•ì¸ ë° í•´ê²° ë°©ì•ˆ

            #### 2. ë‹¤ìŒ ë‹¨ê³„ ìš°ì„ ìˆœìœ„
            - [ ] ë‹¤ìŒ ë¶„ê¸° ëª©í‘œ ì„¤ì •
            - [ ] ìš°ì„ ìˆœìœ„ ìž¬ì¡°ì • (ë¹„ì¦ˆë‹ˆìŠ¤ ê°€ì¹˜, ê¸°ìˆ  ë¶€ì±„, ì‚¬ìš©ìž í”¼ë“œë°±)
            - [ ] ë¦¬ì†ŒìŠ¤ í• ë‹¹ ê³„íš

            #### 3. ë°±ë¡œê·¸ ì •ë¦¬
            - [ ] ì™„ë£Œëœ ìž‘ì—… ì•„ì¹´ì´ë¸Œ
            - [ ] ë” ì´ìƒ í•„ìš” ì—†ëŠ” ìž‘ì—… ì œê±°
            - [ ] ìƒˆë¡œìš´ ìš”êµ¬ì‚¬í•­ ì¶”ê°€

            #### 4. ë¬¸ì„œ ì—…ë°ì´íŠ¸
            - [ ] [docs/project/roadmap.md](docs/project/roadmap.md) ì—…ë°ì´íŠ¸
            - [ ] [project-todo.md](project-todo.md) ìš°ì„ ìˆœìœ„ ìž¬ì •ë ¬
            - [ ] [CLAUDE.md](CLAUDE.md) ë¡œë“œë§µ ì„¹ì…˜ ì—…ë°ì´íŠ¸

            ### ë¶„ê¸° íšŒê³ 

            #### ì§€ë‚œ ë¶„ê¸° ì„±ê³¼
            - ì™„ë£Œëœ Phase:
            - ì£¼ìš” ë‹¬ì„± ì§€í‘œ:
            - ê¸°ìˆ  ìŠ¤íƒ ë³€ê²½:

            #### ë‹¤ìŒ ë¶„ê¸° ëª©í‘œ
            - ëª©í‘œ Phase:
            - ì£¼ìš” ê¸°ëŠ¥:
            - ì˜ˆìƒ ë¦´ë¦¬ìŠ¤:

            ### ì²´í¬ë¦¬ìŠ¤íŠ¸
            - [ ] ë°±ë¡œê·¸ ìš°ì„ ìˆœìœ„ ìž¬ì¡°ì • ì™„ë£Œ
            - [ ] ë¡œë“œë§µ ë¬¸ì„œ ì—…ë°ì´íŠ¸
            - [ ] ë‹¤ìŒ ë¶„ê¸° Sprint ê³„íš ìˆ˜ë¦½
            - [ ] íŒ€ ë™ê¸°í™” ì™„ë£Œ

            ### ì°¸ê³  ë¬¸ì„œ
            - [í”„ë¡œì íŠ¸ ë¡œë“œë§µ](docs/project/roadmap.md)
            - [ë³€ê²½ ë¡œê·¸](docs/project/changelog.md)
            - [ë°±ë¡œê·¸ ê´€ë¦¬ ê°€ì´ë“œ](docs/guides/backlog-management.md)

            ---
            ðŸ¤– Automated by GitHub Actions

            **ë‹¤ìŒ ê²€í† **: ${year} Q${parseInt(quarter.slice(1)) + 1 > 4 ? 1 : parseInt(quarter.slice(1)) + 1}`,
              labels: ['planning', 'backlog', 'quarterly-review', 'automated'],
              assignees: [context.repo.owner]
            });

            console.log(\`Issue created: \${issue.data.html_url}\`);
