name: Weekly Docs Size Check

# ë§¤ì£¼ ì¼ìš”ì¼ 00:00 (UTC) = ë§¤ì£¼ ì¼ìš”ì¼ 09:00 (KST)
on:
  schedule:
    - cron: '0 0 * * 0'  # ë§¤ì£¼ ì¼ìš”ì¼
  workflow_dispatch:  # ìˆ˜ë™ ì‹¤í–‰ ê°€ëŠ¥

jobs:
  check-docs-size:
    name: Check Documentation Size
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Check docs size
        id: check
        run: |
          node scripts/check-docs-size.js
        continue-on-error: true

      - name: Create Issue on Warning
        if: steps.check.outcome == 'failure'
        uses: actions/github-script@v7
        with:
          script: |
            const now = new Date().toISOString().split('T')[0];

            const issue = await github.rest.issues.create({
              owner: context.repo.owner,
              repo: context.repo.repo,
              title: `âš ï¸ ë¬¸ì„œ í¬ê¸° ê²½ê³  (${now})`,
              body: `## âš ï¸ ë¬¸ì„œ í¬ê¸°ê°€ ëª©í‘œë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤

            **ì²´í¬ ë‚ ì§œ**: ${now}
            **ìë™í™”**: GitHub Actions (weekly-docs-check.yml)

            ### ê¶Œì¥ ì¡°ì¹˜

            #### CLAUDE.md (ëª©í‘œ: 800 ë¼ì¸ ì´í•˜)
            - ê³¼ê±° ì—…ë°ì´íŠ¸ë¥¼ \`docs/archive/CLAUDE-history-*.md\`ë¡œ ì´ë™
            - ìµœì‹  ì—…ë°ì´íŠ¸ 5ê°œë§Œ ìœ ì§€
            - í•µì‹¬ ì„¹ì…˜(SDD, Constitution, ê¸°ìˆ  ìŠ¤íƒ ë“±)ì€ ìœ ì§€

            #### project-todo.md (ëª©í‘œ: 300 ë¼ì¸ ì´í•˜)
            - ì™„ë£Œëœ ì‘ì—…ì„ ì•„ì¹´ì´ë¸Œë¡œ ì´ë™
            - ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰: \`node scripts/archive-completed-todos.js\`
            - ì§„í–‰ ì¤‘/ëŒ€ê¸° ì¤‘ ì‘ì—…ë§Œ ìœ ì§€

            ### ìë™ ì •ë¦¬
            - **ì›”ê°„**: ì™„ë£Œëœ TODO ìë™ ì•„ì¹´ì´ë¸Œ (ë§¤ì›” 1ì¼)
            - **ì£¼ê°„**: ë¬¸ì„œ í¬ê¸° ì²´í¬ (ë§¤ì£¼ ì¼ìš”ì¼)

            ### ì°¸ê³  ë¬¸ì„œ
            - [ë¬¸ì„œ ì •ë¦¬ ê°€ì´ë“œ](docs/guides/documentation-maintenance.md)
            - [ì•„ì¹´ì´ë¸Œ ì „ëµ](docs/archive/README.md)

            ---
            ğŸ¤– Automated by GitHub Actions`,
              labels: ['documentation', 'maintenance', 'automated']
            });

            console.log(\`Issue created: \${issue.data.html_url}\`);

      - name: Success
        if: steps.check.outcome == 'success'
        run: |
          echo "âœ… ëª¨ë“  ë¬¸ì„œê°€ ëª©í‘œ í¬ê¸° ë‚´ì— ìˆìŠµë‹ˆë‹¤!"
