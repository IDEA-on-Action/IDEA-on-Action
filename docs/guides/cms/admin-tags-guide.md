# AdminTags 관리 가이드

## 개요

### 목적
AdminTags 페이지는 블로그 포스트 및 기타 콘텐츠에 사용되는 태그를 관리하는 관리자 전용 페이지입니다. 태그를 생성하고 사용 횟수를 추적할 수 있습니다.

### 주요 기능
- 태그 목록 조회
- 태그 검색
- 태그 생성, 수정, 삭제
- 사용 횟수 표시 및 추적

### 접근 권한
- **필요 권한**: Admin 이상 (editor, admin, super_admin)
- **접근 경로**: `/admin/tags`

---

## 화면 구성

### 목록 화면
- **상단**: 페이지 제목, "새 태그" 버튼
- **검색**: 태그명 또는 slug 검색창
- **테이블 컬럼**:
  - 태그명: 태그 이름
  - Slug: URL에 사용되는 kebab-case 문자열
  - 사용 횟수: 태그가 사용된 횟수 뱃지
  - 작업: 수정, 삭제 버튼

### 생성/편집 화면
- **모달 다이얼로그** 형태로 표시 (작은 크기, max-w-md)
- **폼 필드**:
  - 태그명: 태그 이름 (예: React Query)
  - Slug: URL-friendly 문자열 (kebab-case, 예: react-query)
  - 사용 횟수: 읽기 전용 (수정 시에만 표시)

---

## 기능 사용법

### 1. 조회

#### 목록 조회
1. `/admin/tags` 페이지에 접속합니다.
2. 등록된 모든 태그가 테이블로 표시됩니다.
3. 각 태그의 이름, slug, 사용 횟수를 한눈에 확인할 수 있습니다.

#### 검색
1. 상단 검색창에 태그명 또는 slug의 일부를 입력합니다.
2. 입력과 동시에 실시간으로 필터링됩니다.
3. 검색어는 대소문자 구분 없이 동작합니다.

#### 필터링
- 현재 버전에서는 검색 기능만 제공하며, 별도의 필터는 없습니다.

#### 정렬
- 기본 정렬: 최근 생성순 (created_at DESC)
- 테이블 헤더 클릭으로 정렬 변경 불가 (현재 버전)

---

### 2. 생성

#### 필수 입력 항목
- **태그명** (필수): 태그 이름 (예: React Query)
- **Slug** (필수): kebab-case 형식 (예: react-query)

#### 선택 입력 항목
- 없음 (태그명과 Slug만 입력)

#### 폼 검증 규칙
- **태그명**: 최소 1자 이상
- **Slug**: kebab-case 형식 (정규식: `^[a-z0-9]+(?:-[a-z0-9]+)*$`)
  - 소문자, 숫자, 하이픈만 허용
  - 하이픈은 단어 사이에만 사용 가능
  - 예시: react-query, typescript, web-development

#### 저장 프로세스
1. 우측 상단 "새 태그" 버튼을 클릭합니다.
2. 모달 다이얼로그가 열립니다.
3. 필수 항목(태그명, Slug)을 입력합니다.
4. "저장" 버튼을 클릭합니다.
5. 저장 중: "저장 중..." 메시지 표시, 버튼 비활성화
6. 저장 완료: "태그 생성 완료" 토스트 메시지 표시, 모달 닫힘
7. 저장 실패: "태그 생성 실패" 토스트 메시지 표시, 오류 내용 표시

**참고**: 새로 생성된 태그의 사용 횟수는 자동으로 0으로 초기화됩니다.

---

### 3. 수정

#### 수정 가능 항목
- 태그명
- Slug

#### 수정 불가 항목
- ID (자동 생성)
- 생성일 (createdAt)
- 수정일 (updatedAt, 자동 업데이트)
- 사용 횟수 (usageCount, 읽기 전용, 자동 계산)

#### 수정 프로세스
1. 테이블에서 수정하려는 태그의 "수정" 버튼(연필 아이콘)을 클릭합니다.
2. 모달 다이얼로그가 열리고 기존 값이 폼에 채워집니다.
3. 수정하려는 항목의 값을 변경합니다.
4. 사용 횟수는 읽기 전용으로 표시되며 수정할 수 없습니다.
5. "저장" 버튼을 클릭합니다.
6. 저장 완료: "태그 수정 완료" 토스트 메시지 표시, 모달 닫힘
7. 저장 실패: "태그 수정 실패" 토스트 메시지 표시, 오류 내용 표시

---

### 4. 삭제

#### 삭제 조건
- 관리자 권한이 있는 사용자만 삭제 가능
- **주의**: 태그를 사용 중인 항목이 있어도 삭제할 수 있습니다 (경고 메시지 표시).

#### 연관 데이터 처리
- **사용 횟수 확인**: 삭제 확인 다이얼로그에서 사용 횟수를 표시합니다.
- **사용 중인 항목**: 삭제 시 해당 태그를 사용하는 블로그 포스트 등에서 태그가 제거됩니다.

#### 삭제 프로세스
1. 테이블에서 삭제하려는 태그의 "삭제" 버튼(휴지통 아이콘)을 클릭합니다.
2. 삭제 확인 다이얼로그가 표시됩니다.
3. 메시지:
   - 사용 횟수가 0일 경우: "정말로 이 태그를 삭제하시겠습니까? 이 작업은 되돌릴 수 없습니다."
   - 사용 횟수가 0보다 클 경우: "이 태그는 현재 N개의 항목에서 사용 중입니다. 삭제하시겠습니까? 이 작업은 되돌릴 수 없습니다."
4. "삭제" 버튼을 클릭하여 확인합니다.
5. 삭제 완료: "태그 삭제 완료" 토스트 메시지 표시
6. 삭제 실패: "태그 삭제 실패" 토스트 메시지 표시, 오류 내용 표시

---

## 주의사항

### 데이터 일관성
- **Slug 중복**: Slug는 고유해야 하지만 시스템에서 중복 검사를 하지 않습니다. 수동으로 고유성을 확인하세요.
- **Slug 형식**: kebab-case 형식만 허용됩니다. 대문자, 공백, 특수문자(하이픈 제외)는 사용할 수 없습니다.
- **사용 횟수**: 사용 횟수는 자동으로 계산되며 수동으로 변경할 수 없습니다.
- **사용 중인 태그 삭제**: 사용 중인 태그를 삭제하면 해당 태그를 사용하는 블로그 포스트 등에서 태그가 제거됩니다.

### 권한 관리
- **Admin 이상 필요**: editor, admin, super_admin 역할만 접근 가능합니다.
- **RLS 정책**: Supabase RLS 정책에 따라 권한이 제어됩니다.

### 에러 처리
- **네트워크 오류**: 네트워크 연결 실패 시 "알 수 없는 오류가 발생했습니다." 메시지 표시
- **필수 항목 누락**: 필수 항목 미입력 시 빨간색 오류 메시지 표시, 저장 불가
- **Slug 형식 오류**: Slug 필드에 잘못된 형식 입력 시 "Slug는 kebab-case 형식이어야 합니다 (예: react-query)" 오류 메시지 표시

---

## FAQ

### Q1: 사용 횟수는 어떻게 계산되나요?
**A**: 사용 횟수는 해당 태그를 사용하는 블로그 포스트 및 기타 콘텐츠의 개수를 자동으로 계산합니다. 태그를 추가하거나 제거하면 자동으로 업데이트됩니다.

### Q2: 사용 횟수 뱃지의 색상은 무엇을 의미하나요?
**A**: 사용 횟수에 따라 뱃지 색상이 달라집니다:
- **미사용** (0): 회색 아웃라인 뱃지
- **1-4**: 회색 뱃지
- **5-19**: 파란색 뱃지 (기본)
- **20 이상**: 초록색 뱃지 (인기 태그)

### Q3: Slug를 변경하면 어떤 영향이 있나요?
**A**: Slug를 변경하면 해당 태그를 사용하는 URL도 변경됩니다. 기존 URL로 접근하던 사용자는 404 오류를 볼 수 있으므로 주의하세요. 가능하면 Slug는 생성 시 신중하게 설정하고 변경하지 않는 것이 좋습니다.

### Q4: 사용 중인 태그를 삭제하면 어떻게 되나요?
**A**: 사용 중인 태그를 삭제하면 해당 태그를 사용하는 블로그 포스트 등에서 태그가 자동으로 제거됩니다. 삭제 전 확인 메시지에서 사용 횟수를 확인할 수 있습니다.

### Q5: 태그명과 Slug를 다르게 설정할 수 있나요?
**A**: 네, 태그명과 Slug는 다르게 설정할 수 있습니다. 예를 들어, 태그명은 "React Query"이고 Slug는 "react-query"일 수 있습니다. 태그명은 사용자에게 표시되고, Slug는 URL에 사용됩니다.

### Q6: 태그는 몇 개까지 만들 수 있나요?
**A**: 태그 개수에 제한은 없습니다. 단, 너무 많은 태그는 관리가 어려워질 수 있습니다. 비슷한 태그는 하나로 통합하는 것이 좋습니다.

### Q7: 사용하지 않는 태그를 찾는 방법은?
**A**: 검색창을 비워두고 전체 태그 목록을 확인하세요. 사용 횟수가 "미사용" 뱃지로 표시된 태그가 사용하지 않는 태그입니다. 이러한 태그는 삭제를 고려할 수 있습니다.
