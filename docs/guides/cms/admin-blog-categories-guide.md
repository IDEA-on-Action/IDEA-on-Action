# AdminBlogCategories 관리 가이드

## 개요

### 목적
AdminBlogCategories 페이지는 블로그 포스트의 카테고리를 관리하는 관리자 전용 페이지입니다. 카테고리를 생성하고 각 카테고리의 색상, 아이콘, 설명을 설정할 수 있습니다.

### 주요 기능
- 블로그 카테고리 목록 조회
- 카테고리 검색
- 카테고리 생성, 수정, 삭제
- 카테고리 색상 및 아이콘 관리
- 포스트 개수 표시

### 접근 권한
- **필요 권한**: Admin 이상 (editor, admin, super_admin)
- **접근 경로**: `/admin/blog/categories`

---

## 화면 구성

### 목록 화면
- **상단**: 페이지 제목, "새 카테고리" 버튼
- **검색**: 이름, slug, 설명 검색창
- **테이블 컬럼**:
  - 색상: 색상 미리보기 박스 (6x6 픽셀) 및 Hex 코드
  - 이름: 카테고리 이름
  - Slug: URL에 사용되는 kebab-case 문자열
  - 아이콘: Lucide 아이콘 이름
  - 포스트 수: 해당 카테고리에 속한 포스트 개수 뱃지
  - 작업: 수정, 삭제 버튼

### 생성/편집 화면
- **모달 다이얼로그** 형태로 표시
- **스크롤 가능**: 최대 높이 90vh, 초과 시 스크롤
- **폼 필드**:
  - 이름: 카테고리 이름
  - Slug: URL-friendly 문자열 (kebab-case)
  - 설명: 카테고리 설명
  - 색상: Hex 색상 코드 (예: #3b82f6) + 미리보기
  - 아이콘: Lucide 아이콘 이름 (예: folder, code, palette)

---

## 기능 사용법

### 1. 조회

#### 목록 조회
1. `/admin/blog/categories` 페이지에 접속합니다.
2. 등록된 모든 블로그 카테고리가 테이블로 표시됩니다.
3. 각 카테고리의 색상, 이름, slug, 아이콘, 포스트 개수를 한눈에 확인할 수 있습니다.

#### 검색
1. 상단 검색창에 이름, slug, 설명의 일부를 입력합니다.
2. 입력과 동시에 실시간으로 필터링됩니다.
3. 검색어는 대소문자 구분 없이 동작합니다.

#### 필터링
- 현재 버전에서는 검색 기능만 제공하며, 별도의 필터는 없습니다.

#### 정렬
- 기본 정렬: 최근 생성순 (created_at DESC)
- 테이블 헤더 클릭으로 정렬 변경 불가 (현재 버전)

---

### 2. 생성

#### 필수 입력 항목
- **이름** (필수): 카테고리 이름 (예: 기술, 디자인)
- **Slug** (필수): kebab-case 형식 (예: tech, my-category)
- **색상** (필수): Hex 색상 코드 (예: #3b82f6, 기본값 #3b82f6)

#### 선택 입력 항목
- **설명**: 카테고리 설명
- **아이콘**: Lucide 아이콘 이름 (기본값: folder)

#### 폼 검증 규칙
- **이름**: 최소 1자 이상
- **Slug**: kebab-case 형식 (정규식: `^[a-z0-9]+(?:-[a-z0-9]+)*$`)
  - 소문자, 숫자, 하이픈만 허용
  - 하이픈은 단어 사이에만 사용 가능
  - 예시: tech, my-category, web-development-2024
- **색상**: Hex 색상 코드 형식 (정규식: `^#[0-9A-Fa-f]{6}$`)
  - 예시: #3b82f6, #f59e0b, #8b5cf6

#### 저장 프로세스
1. 우측 상단 "새 카테고리" 버튼을 클릭합니다.
2. 모달 다이얼로그가 열립니다.
3. 필수 항목(이름, Slug, 색상)을 입력합니다.
4. 선택 항목(설명, 아이콘)을 필요에 따라 입력합니다.
5. 색상 필드 옆에 색상 미리보기가 실시간으로 표시됩니다.
6. "저장" 버튼을 클릭합니다.
7. 저장 중: "저장 중..." 메시지 표시, 버튼 비활성화
8. 저장 완료: "카테고리 생성 완료" 토스트 메시지 표시, 모달 닫힘
9. 저장 실패: "카테고리 생성 실패" 토스트 메시지 표시, 오류 내용 표시

---

### 3. 수정

#### 수정 가능 항목
- 모든 필드 수정 가능 (이름, Slug, 설명, 색상, 아이콘)

#### 수정 불가 항목
- ID (자동 생성)
- 생성일 (createdAt)
- 수정일 (updatedAt, 자동 업데이트)
- 포스트 개수 (postCount, 자동 계산)

#### 수정 프로세스
1. 테이블에서 수정하려는 카테고리의 "수정" 버튼(연필 아이콘)을 클릭합니다.
2. 모달 다이얼로그가 열리고 기존 값이 폼에 채워집니다.
3. 수정하려는 항목의 값을 변경합니다.
4. "저장" 버튼을 클릭합니다.
5. 저장 완료: "카테고리 수정 완료" 토스트 메시지 표시, 모달 닫힘
6. 저장 실패: "카테고리 수정 실패" 토스트 메시지 표시, 오류 내용 표시

---

### 4. 삭제

#### 삭제 조건
- 관리자 권한이 있는 사용자만 삭제 가능
- **중요**: 해당 카테고리에 포스트가 있으면 삭제할 수 없습니다.

#### 연관 데이터 처리
- **포스트 개수 확인**: 삭제 시도 시 카테고리의 포스트 개수를 확인합니다.
- **포스트가 있을 경우**: 삭제 불가, 오류 메시지 표시
  - "이 카테고리에는 N개의 포스트가 있습니다. 먼저 포스트를 삭제하거나 다른 카테고리로 이동하세요."
- **포스트가 없을 경우**: 삭제 가능

#### 삭제 프로세스
1. 테이블에서 삭제하려는 카테고리의 "삭제" 버튼(휴지통 아이콘)을 클릭합니다.
2. 삭제 확인 다이얼로그가 표시됩니다.
3. 메시지:
   - 포스트가 없을 경우: "정말로 이 카테고리를 삭제하시겠습니까?"
   - 포스트가 있을 경우: "경고: 이 카테고리에는 N개의 포스트가 있습니다."
4. "삭제" 버튼을 클릭하여 확인합니다.
5. 포스트 개수 확인:
   - 포스트가 있으면: 삭제 중단, "삭제 불가" 토스트 메시지 표시
   - 포스트가 없으면: 삭제 진행
6. 삭제 완료: "카테고리 삭제 완료" 토스트 메시지 표시
7. 삭제 실패: "카테고리 삭제 실패" 토스트 메시지 표시, 오류 내용 표시

---

## 주의사항

### 데이터 일관성
- **Slug 중복**: Slug는 고유해야 하지만 시스템에서 중복 검사를 하지 않습니다. 수동으로 고유성을 확인하세요.
- **Slug 형식**: kebab-case 형식만 허용됩니다. 대문자, 공백, 특수문자(하이픈 제외)는 사용할 수 없습니다.
- **색상 형식**: Hex 색상 코드는 #으로 시작하고 6자리 16진수여야 합니다. 예: #3b82f6
- **포스트 개수**: 카테고리에 포스트가 있으면 삭제할 수 없습니다. 먼저 포스트를 다른 카테고리로 이동하거나 삭제하세요.

### 권한 관리
- **Admin 이상 필요**: editor, admin, super_admin 역할만 접근 가능합니다.
- **RLS 정책**: Supabase RLS 정책에 따라 권한이 제어됩니다.

### 에러 처리
- **네트워크 오류**: 네트워크 연결 실패 시 "알 수 없는 오류가 발생했습니다." 메시지 표시
- **필수 항목 누락**: 필수 항목 미입력 시 빨간색 오류 메시지 표시, 저장 불가
- **Slug 형식 오류**: Slug 필드에 잘못된 형식 입력 시 "kebab-case 형식이어야 합니다 (예: tech, my-category)" 오류 메시지 표시
- **색상 형식 오류**: 색상 필드에 잘못된 형식 입력 시 "올바른 hex 색상 코드를 입력하세요 (예: #3b82f6)" 오류 메시지 표시
- **삭제 불가**: 포스트가 있는 카테고리 삭제 시도 시 "삭제 불가" 토스트 메시지 표시

---

## FAQ

### Q1: 카테고리 색상은 어떻게 선택하나요?
**A**: 색상 필드에 Hex 색상 코드를 직접 입력합니다. 예시:
- 파란색: #3b82f6
- 주황색: #f59e0b
- 보라색: #8b5cf6
- 초록색: #10b981
- 빨간색: #ef4444

입력과 동시에 오른쪽에 색상 미리보기가 표시됩니다.

### Q2: 아이콘은 어떤 것을 사용할 수 있나요?
**A**: Lucide 아이콘 이름을 입력합니다. 예시:
- folder (기본값)
- code (코드/기술)
- palette (디자인)
- briefcase (비즈니스)
- book (문서/튜토리얼)

전체 아이콘 목록은 [Lucide 아이콘 사이트](https://lucide.dev/icons)에서 확인할 수 있습니다.

### Q3: Slug는 나중에 변경할 수 있나요?
**A**: 네, Slug는 수정 가능합니다. 단, Slug를 변경하면 해당 카테고리를 사용하는 URL도 변경되므로 주의하세요. 기존 URL로 접근하던 사용자는 404 오류를 볼 수 있습니다.

### Q4: 포스트가 있는 카테고리를 삭제하려면 어떻게 하나요?
**A**: 먼저 해당 카테고리의 모든 포스트를 다른 카테고리로 이동하거나 삭제해야 합니다. 그 후 카테고리를 삭제할 수 있습니다.

### Q5: 카테고리는 몇 개까지 만들 수 있나요?
**A**: 카테고리 개수에 제한은 없습니다. 단, 너무 많은 카테고리는 사용자가 콘텐츠를 찾기 어렵게 만들 수 있습니다. 5-10개 정도가 적절합니다.

### Q6: 카테고리 설명은 어디에 표시되나요?
**A**: 카테고리 설명은 블로그 카테고리 목록 페이지 또는 카테고리별 포스트 목록 페이지에서 표시됩니다. SEO에도 도움이 됩니다.
